# Linux Команды и Опции (справка)

## `ls`
### Команда
```bash
ls -la
```
Что делает: показывает все файлы (включая скрытые) в длинном формате.
Параметры:
- `-l` - длинный формат (права, владелец, размер, время).
- `-a` - скрытые файлы (`.` и `..`).

### Команда
```bash
ls -lc
```
Что делает: показывает `ctime` вместо `mtime`.
Параметры:
- `-l` - длинный формат.
- `-c` - использовать время изменения метаданных (ctime).

## `find`
### Команда
```bash
find / -type f -user bob -mmin -1 2>/dev/null
```
Что делает: ищет файлы пользователя bob, измененные за последнюю минуту.
Параметры:
- `/` - корень поиска.
- `-type f` - только файлы.
- `-user bob` - владелец bob.
- `-mmin -1` - моложе 1 минуты.

### Команда
```bash
find / -xdev -perm -4000 -type f 2>/dev/null
```
Что делает: ищет SUID файлы на текущей ФС.
Параметры:
- `-xdev` - не переходить на другие ФС.
- `-perm -4000` - SUID установлен.

## `grep`
### Команда
```bash
grep -RinE 'failed|invalid user|accepted|sudo' /var/log 2>/dev/null
```
Что делает: ищет auth-события по логам.
Параметры:
- `-R` рекурсивно.
- `-i` без учета регистра.
- `-n` номер строки.
- `-E` расширенные regex.

## `journalctl`
### Команда
```bash
journalctl -u ssh --since '-12h' --no-pager
```
Что делает: ssh-логи за 12 часов.
Параметры:
- `-u ssh` сервис ssh.
- `--since` время начала.
- `--no-pager` без постраничного вывода.

## `ss`
### Команда
```bash
ss -tulpen
```
Что делает: сокеты и сетевые слушатели.
Параметры:
- `-t` TCP
- `-u` UDP
- `-l` listening
- `-p` процесс
- `-e` расширенный вывод
- `-n` без DNS-резолва

## `stat`
### Команда
```bash
stat /path/file
```
Что делает: показывает inode, права, atime/mtime/ctime.
Параметры: путь к файлу.

## `getcap`
### Команда
```bash
getcap -r /
```
Что делает: рекурсивно ищет capabilities.
Параметры: `-r` рекурсивный обход.

## `pdpl-user` (Astra)
### Команда
```bash
pdpl-user investigator
```
Что делает: показывает мандатные атрибуты пользователя.
Параметры: имя пользователя.

## `pdpl-file` (Astra)
### Команда
```bash
pdpl-file /etc/ssh
```
Что делает: показывает мандатные атрибуты объекта ФС.
Параметры: путь к файлу/директории.
